<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.37" />
    <meta name="description" content="Documentation for Fission">
<meta name="author" content="Fission">

    <link rel="shortcut icon" href=/0.6.1/images/favicon.png type="image/x-icon" />
<link rel="icon" href=/0.6.1/images/favicon.png type="image/x-icon" />

    <title>Packaging source code :: Serverless Functions for Kubernetes</title>
    
    
    <link href="/0.6.1/css/nucleus.css?1522708244" rel="stylesheet">
    <link href="/0.6.1/css/font-awesome.min.css?1522708244" rel="stylesheet">
    <link href="/0.6.1/css/hybrid.css?1522708244" rel="stylesheet">
    <link href="/0.6.1/css/featherlight.min.css?1522708244" rel="stylesheet">
    <link href="/0.6.1/css/perfect-scrollbar.min.css?1522708244" rel="stylesheet">
    <link href="/0.6.1/css/auto-complete.css?1522708244" rel="stylesheet">
    <link href="/0.6.1/css/theme.css?1522708244" rel="stylesheet">
    <link href="/0.6.1/css/hugo-theme.css?1522708244" rel="stylesheet">
    
      <link href="/0.6.1/css/theme-fission.css?1522708244" rel="stylesheet">
    

    <script src="/0.6.1/js/jquery-2.x.min.js?1522708244"></script>
    
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{ 
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/0.6.1/usage/package/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="http://fission.io/">
  <img src=/0.6.1/images/fission-logo.png>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>

<script type="text/javascript" src="/0.6.1/js/lunr.min.js?1522708244"></script>
<script type="text/javascript" src="/0.6.1/js/auto-complete.js?1522708244"></script>
<script type="text/javascript">
    
        var baseurl = '\/0.6.1';
    
</script>
<script type="text/javascript" src="/0.6.1/js/search.js?1522708244"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/0.6.1/installation/" title="Installation Guide" class="dd-item 
        
        
        
        ">
      <a href="/0.6.1/installation/">
          Installation Guide
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/installation/installation/" title="Installation Guide" class="dd-item ">
        <a href="/0.6.1/installation/installation/">
        Installation Guide
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/installation/kubernetessetup/" title="Kubernetes Quick Install" class="dd-item ">
        <a href="/0.6.1/installation/kubernetessetup/">
        Kubernetes Quick Install
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/installation/releasenotes/" title="Release notes" class="dd-item ">
        <a href="/0.6.1/installation/releasenotes/">
        Release notes
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/0.6.1/installation/upgrade/" title="Upgrade" class="dd-item 
        
        
        
        ">
      <a href="/0.6.1/installation/upgrade/">
          Upgrade
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/installation/upgrade/upgrade-from-v0.1/" title="Upgrading from v0.1 to v0.2.x" class="dd-item ">
        <a href="/0.6.1/installation/upgrade/upgrade-from-v0.1/">
        Upgrading from v0.1 to v0.2.x
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/installation/upgrade/upgrade-from-v0.3/" title="Upgrading from v0.3 to v0.4.x" class="dd-item ">
        <a href="/0.6.1/installation/upgrade/upgrade-from-v0.3/">
        Upgrading from v0.3 to v0.4.x
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/installation/upgrade/upgrade-from-v0.4/" title="Upgrading from v0.4.x to v0.5.0" class="dd-item ">
        <a href="/0.6.1/installation/upgrade/upgrade-from-v0.4/">
        Upgrading from v0.4.x to v0.5.0
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/0.6.1/concepts/" title="Fission Concepts" class="dd-item 
        
        
        
        ">
      <a href="/0.6.1/concepts/">
          Fission Concepts
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/concepts/environments/" title="Environments" class="dd-item ">
        <a href="/0.6.1/concepts/environments/">
        Environments
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/concepts/executor/" title="Controlling Function Execution" class="dd-item ">
        <a href="/0.6.1/concepts/executor/">
        Controlling Function Execution
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/concepts/trigger/" title="Trigger" class="dd-item ">
        <a href="/0.6.1/concepts/trigger/">
        Trigger
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/concepts/package/" title="Builder and Packages" class="dd-item ">
        <a href="/0.6.1/concepts/package/">
        Builder and Packages
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/0.6.1/usage/" title="Using Fission" class="dd-item 
        parent
        
        
        ">
      <a href="/0.6.1/usage/">
          Using Fission
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/usage/functions/" title="Function" class="dd-item ">
        <a href="/0.6.1/usage/functions/">
        Function
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/usage/environments/" title="Environment" class="dd-item ">
        <a href="/0.6.1/usage/environments/">
        Environment
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/usage/executor/" title="Controlling Function Execution" class="dd-item ">
        <a href="/0.6.1/usage/executor/">
        Controlling Function Execution
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/usage/trigger/" title="Triggers" class="dd-item ">
        <a href="/0.6.1/usage/trigger/">
        Triggers
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/usage/package/" title="Packaging source code" class="dd-item active">
        <a href="/0.6.1/usage/package/">
        Packaging source code
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/usage/access-secret-cfgmap-in-function/" title="Accessing Secrets in Functions" class="dd-item ">
        <a href="/0.6.1/usage/access-secret-cfgmap-in-function/">
        Accessing Secrets in Functions
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/0.6.1/contributing/" title="Contributing to Fission" class="dd-item 
        
        
        
        ">
      <a href="/0.6.1/contributing/">
          Contributing to Fission
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/contributing/compiling/" title="Compiling Fission" class="dd-item ">
        <a href="/0.6.1/contributing/compiling/">
        Compiling Fission
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/0.6.1/workflows/" title="Fission Workflows" class="dd-item 
        
        
        
        ">
      <a href="/0.6.1/workflows/">
          Fission Workflows
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/0.6.1/tutorial/" title="Tutorials" class="dd-item 
        
        
        
        ">
      <a href="/0.6.1/tutorial/">
          Tutorials
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/0.6.1/tutorial/enabling-istio-on-fission/" title="Enabling Istio on Fission" class="dd-item ">
        <a href="/0.6.1/tutorial/enabling-istio-on-fission/">
        Enabling Istio on Fission
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li class="" role=""> 
                  <a class="padding" href="https://github.com/fission/fission"><i class='fa fa-fw fa-github'></i> Github repo</a>
              </li>
          
              <li class="" role=""> 
                  <a class="padding" href="https://github.com/fission/fission/graphs/contributors"><i class='fa fa-fw fa-bullhorn'></i> Credits</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fa fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/fission/docs.fission.io/edit/master/docs/content/usage/package.en.md" target="blank">
                      <i class="fa fa-code-fork"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/0.6.1/'>Fission</a> > <a href='/0.6.1/usage/'>Using Fission</a> > Packaging source code
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#creating-source-package">Creating source package</a></li>
<li><a href="#creating-deployment-package">Creating deployment package</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Packaging source code</h1>
          

        




<h3 id="creating-source-package">Creating source package</h3>

<p>Before you create a package, you need to create an environment with associated builder image:</p>

<pre><code>$ fission env create --name pythonsrc --image fission/python-env:latest --builder fission/python-builder:latest --mincpu 40 --maxcpu 80 --minmemory 64 --maxmemory 128 --poolsize 2
environment 'pythonsrc' created
</code></pre>

<p>Let&rsquo;s take a simple python function which has dependency on a python pyyaml module. We can specify the dependencies in requirements.txt and a simple command to build from source. The tree structure of directory and contents of the file looks like:</p>

<pre><code>sourcepkg/
├── __init__.py
├── build.sh
├── requirements.txt
└── user.py
</code></pre>

<p>And the file contents:</p>

<pre><code>$ cat user.py 
import sys
import yaml

document = &quot;&quot;&quot;
  a: 1
  b:
    c: 3
    d: 4
&quot;&quot;&quot;

def main():
    return yaml.dump(yaml.load(document))

$ cat requirements.txt 
pyyaml

$ cat build.sh 
#!/bin/sh
pip3 install -r ${SRC_PKG}/requirements.txt -t ${SRC_PKG} &amp;&amp; cp -r ${SRC_PKG} ${DEPLOY_PKG}

$zip -jr demo-src-pkg.zip sourcepkg/
  adding: __init__.py (stored 0%)
  adding: build.sh (deflated 24%)
  adding: requirements.txt (stored 0%)
  adding: user.py (deflated 25%)
</code></pre>

<p>Using the source archive creared in previous step, you can create a package in Fission:</p>

<pre><code>$ fission package create --sourcearchive demo-src-pkg.zip --env pythonsrc --buildcmd &quot;./build.sh&quot;
Package 'demo-src-pkg-zip-8lwt' created
</code></pre>

<p>Since we are working with source package, we provided the build command. Once you create the package, the build process will start and you can check the build logs by getting information of the package:</p>

<pre><code>$ fission pkg info --name demo-src-pkg-zip-8lwt
Name:        demo-src-pkg-zip-8lwt
Environment: pythonsrc
Status:      succeeded
Build Logs:
Collecting pyyaml (from -r /packages/demo-src-pkg-zip-8lwt-v57qil/requirements.txt (line 1))
  Using cached PyYAML-3.12.tar.gz
Installing collected packages: pyyaml
  Running setup.py install for pyyaml: started
    Running setup.py install for pyyaml: finished with status 'done'
Successfully installed pyyaml-3.12
</code></pre>

<p>Using the package above you can create the function. Since package already is associated with a source package, environment and build command, these will be ignored when creating a function. Only addition thing you will need to provide is the entrypoint. Assuming you hace created the route, the function should be reachable with successful output:</p>

<pre><code>$ fission fn create --name srcpy --pkg demo-src-pkg-zip-8lwt --entrypoint &quot;user.main&quot;
function 'srcpy' created

$ curl http://$FISSION_ROUTER/srcpy
a: 1
b: {c: 3, d: 4}
</code></pre>

<h3 id="creating-deployment-package">Creating deployment package</h3>

<p>Before you create a package you need to create an environment with the builder image:</p>

<pre><code>$ fission env create --name pythondeploy --image fission/python-env:latest --builder fission/python-builder:latest --mincpu 40 --maxcpu 80 --minmemory 64 --maxmemory 128 --poolsize 2
environment 'pythonsrc' created
</code></pre>

<p>We will use a simple Python example which outputs &ldquo;Hello World!&rdquo; in a directory to create a deployment archive:</p>

<pre><code>$ cat testDir/hello.py
def main():
    return &quot;Hello, world!&quot;

$zip -jr demo-deploy-pkg.zip testDir/

</code></pre>

<p>Using the archive and environments created previously, you can create a package:</p>

<pre><code>$ fission package create --deployarchive demo-deploy-pkg.zip --env pythondeploy
Package 'demo-deploy-pkg-zip-whzl' created
</code></pre>

<p>Since it is a deployment archive, there is no need to build it, hence the build logs for the package will be empty:</p>

<pre><code>$ fission package info --name demo-deploy-pkg-zip-whzl
Name:        demo-deploy-pkg-zip-xlaw
Environment: pythondeploy2
Status:      succeeded
Build Logs:
</code></pre>

<p>Finally you can create a function with the package and test the function:</p>

<pre><code>$fission fn create --name deploypy --pkg demo-deploy-pkg-zip-whzl --entrypoint &quot;hello.main&quot;

$curl http://$FISSION_ROUTER/deploypy
Hello, world!
</code></pre>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        

        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/0.6.1/js/clipboard.min.js?1522708244"></script>
    <script src="/0.6.1/js/perfect-scrollbar.min.js?1522708244"></script>
    <script src="/0.6.1/js/perfect-scrollbar.jquery.min.js?1522708244"></script>
    <script src="/0.6.1/js/jquery.sticky.js?1522708244"></script>
    <script src="/0.6.1/js/featherlight.min.js?1522708244"></script>
    <script src="/0.6.1/js/html5shiv-printshiv.min.js?1522708244"></script>
    <script src="/0.6.1/js/highlight.pack.js?1522708244"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/0.6.1/js/modernizr.custom.71422.js?1522708244"></script>
    <script src="/0.6.1/js/learn.js?1522708244"></script>
    <script src="/0.6.1/js/hugo-learn.js?1522708244"></script>

    <link href="/0.6.1/mermaid/mermaid.css?1522708244" type="text/css" rel="stylesheet" />
    <script src="/0.6.1/mermaid/mermaid.js?1522708244"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-86980724-1', 'auto');
  ga('send', 'pageview');
</script>

<script type="text/javascript" src="//script.crazyegg.com/pages/scripts/0059/9755.js" async="async"></script>

  </body>
</html>

